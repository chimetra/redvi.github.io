Title: Arch Linux. Быстрая установка
Date: 2011-10-17 08:25
Update: 7 Июль 2012
Tags: Arch, Linux
Slug: arch-install
Author: redVi
Summary: Статья написана по большей части как быстрый старт для тех, кто уже ознакомился с официальной страничкой вики, и устанавливает систему не в первый раз.

Статья написана по большей части как быстрый старт для тех, кто уже ознакомился с официальной страничкой вики, и устанавливает систему не в первый раз. В случае, если вы никогда ранее не сталкивались с ArchLinux, рекомендуется обратиться [к официальной документации](https://wiki.archlinux.org/index.php/Installation_Guide) по этому вопросу. Арч &mdash; стремительно меняющийся дистрибутив, буквально за два-три месяца (лето-осень 2012) процесс установки претерпел кардинальные изменения, от замены любимого bsd-подобного AIF до gentoo-подобной системы установки, от `rc.conf` и `rc.local` до `netcfg` и `systemd`. Тем не менее: внесены поправки от июля 2012 года, добавлена небольшая видеоинструкция.

`1.` Скачиваем [нужный вам образ](http://mirror.yandex.ru/archlinux/iso/) дистрибутива, прожигаем его на болванку или же делаем загрузочную флешку (например, при помощи `unetbootin` для windows или стандартного `dd` для линукс:

```console
# dd if=имя_образа.iso of=куда_записать
```

Загружаемся с диска/флешки. Если с загрузкой непорядок, например, чёрный экран при загрузке, пробуем грузиться снова и при появлении главного меню жмём TAB, дописываем параметр nomodeset или же указываем с каким разрешением экрана стартовать системе (для разрешения 1366х768 впишите `vga=0x362`).

`2.` Выбор раскладки, отличной от us

```console
# loadkeys ru
```

`3.` Конфигурирование сетевого интерфейса (подробно [в вики](https://wiki.archlinux.org/index.php/Configuring_network)):

Для DSL-соединения:

```console
# pppoe-setup
```

Выполняем настройку по инструкции и стартуем соединение

```console
# pppoe-start
```

Для wi-fi-соединения:

`-` поднимем сеть

```console
# ip link set wlan0 up
```

`-` просканируем доступные точки доступа

```console
# iwlist wlan0 scan
```

`-` получим DNS и IP-адреса через DHCP

```console
# iwconfig wlan0
# dhcpcd wlan0
```

`-` есть ли подключение к интернету:

```console
# ping ya.ru
```

Если пинги идут, значит всё отлично и можно двигаться дальше.

`4.` Разметка жёсткого диска

`-` просмотр всех имеющихся дисков

```console
# fdisk -l
```

`-` теперь нужно создать разделы, отформатировать их в нужную вам файловую систему и назначить точки монтирования для будущих разделов. То есть с 2012 года archlinux ровным счётом ничем не уступает в установке [великой и ужасной Gentoo](install-gentoo.html), так что можете смело читать о нижеописанных действиях немного более подробно в приведённой по ссылке заметке. Впрочем, нелишним будет повториться:

`-` Создание разделов диска:
Для этого воспользуемся `cfdisk`

```console
# cfdisk /dev/sda - где sda ваш-диск
```

* news - создание нового раздела
* type - выбор типа файловой системы (83 - Linux, 82 - swap)
* bootable - отметить как загрузочный (укажите для раздела,в который хотите смонтировать /boot!)
* write - записать изменения
* delete - удалить
* quit - выйти

`-` Назначение файловой системы:

```console
# mkfs.ext4 /dev/sda1 - создание ext4 на разделе /dev/sda1 под /root
# mkfs.ext4  /dev/sda3 - создание ext4 на разделе /dev/sda3 под /home
# mkswap /dev/sda2 - создание раздела подкачки на /dev/sda2
# swapon /dev/sda2 - и его активация
```

`-` Назначение точек монтирования:

```console
# mount /dev/sda1 /mnt - монтируем корень
# mkdir /mnt/home && mount /dev/sda3 /mnt/home - монтирование домашней директории пользователя
```

`5.` Установка базовой системы:

```console
# pacstrap /mnt base base-devel
```

<b>Примечанние:</b> `base-devel` нужен в случае, если вы в будущем собираетесь использовать AUR

`6.` Установка загрузчика (в примере это GRUB2):

Для обычного BIOS:

```console
# pacstrap /mnt grub-bios
```

Для UEFI:

```console
# pacstrap /mnt grub-efi-x86_64
```

И разного рода необходимые мелочи:

`-` Генерация файла `fstab`:

```console
# genfstab -p /mnt >> /mnt/etc/fstab
```

`-` Чрутимся в новую систему:

```console
# arch-chroot /mnt
```

`7.` Конфигурация системы:

В `/etc/hostname` &mdash; пишем имя вашего хоста (машины):
```
# /etc/hostname
myhost
```

Вносим соответствующие правки в `/etc/hosts`:

```
127.0.0.1   myhost localhost ::1   myhost localhost
```

Или так:

```console
# hostnamectl set-hostname myhost
```

Настройка раскладки клавиатуры и шрифтов в `/etc/vconsole.conf`:

```
KEYMAP=ru
FONT=cyr-sun16
FONT_MAP=
```

Временная зона:
В `/etc/timezone`:

```
Europe/Moskow
```

Выполняем:

```console
# ln -s /usr/share/zoneinfo/Europe/Moskow /etc/localtime
```

Для корректной установки системного времени необходимо сгенерировать файл /`etc/adjtime`:

```console
# hwclock --systohc --utc
```

Русский язык:

```console
# nano /etc/locale.gen:
en_US.UTF-8 UTF-8 ru_RU.UTF-8 UTF-8
```

Создаём файл `/etc/locale.conf`:

```
LANG="ru_RU.UTF-8"
```

Или так:

```console
# localectl set-locale LANG="ru_RU.UTF-8"
```

После чего:

```console
# locale-gen
Generating locales...
en_US.UTF-8... done
ru_RU.UTF-8... done
Generation complete.
```

Настройте `/etc/mkinitcpio.conf`,  если это нужно,  и создайте ramdisk:

```console
# mkinitcpio -p linux
```

`8.` Установка загрузчика GRUB2

```console
# grub-install /dev/sda
# grub-mkconfig -o /boot/grub/grub.cfg
```

`9.` Зададим пароль суперпользователя, размонтируем разделы и выйдем из системы:

```console
# passwd
# umount /mnt/home
# umount /mnt
```

`10.` После установки. Из уже новой системы:

Понадобится разобраться с подписями ключей, дабы нормально устанавливать программы:

```console
$ pacman-key --init
$ pacman-key --populate archlinux
```

Ну и настроить интернет заново

И то единственное, что осталось от старого поста об установке (насколько проще было, а?)

Добавление нового пользователя

```console
# adduser
```

Теперь введите его имя пароль и прочее, не забыв прописать в дополнительных группах принадлежность к `wheel` &mdash; группе администраторов. Это чтобы мы могли воспользоваться преимуществами `sudo`.

<b>Примечание:</b> в новых установочных образах команда `adduser` была удалена. Используйте `useradd`:

```console
useradd [параметры] LOGIN
# useradd -g users -G wheel,video -m newbie
```

создаст пользователя с именем `newbie`, с начальной группой `users`, с дополнительными группами `wheel` и `video`, ключ `-m` позволит создать домашний каталог для нового пользователя. Подробнее `man useradd`.

```console
# visudo
```

после ввода этой команды найдите в файле строки

`root ALL=(ALL)ALL` и допишите внизу имя вновь созданного пользователя-админа

`username ALL=(ALL)ALL` выйдите из файла, нажав `Esc` и затем введя `:wq`

Поднимаем сеть (для DSL-соединений) /неактуально, если вы используете `systemd`

```console
$ sudo pppoe-setup
```

теперь вам предстоит ответить на несколько несложных вопросов, перезапустить сеть или же сделать перезагрузку. И можно бороздить просторы глобальной паутины.

Как только подключились к сети, сразу же синхронизируем репозитории:

```console
# pacman -Syy
```

и обновляем систему:

```console
# pacman -Syu
```

Или используем [способ №3 из поста о debian](debian-dsl.html).

<b>Примечание:</b>

```console
# pacman -Rnsc gnome - удаление всех пакетов группы gnome
# pacman -Qdtc - удаление пакетов, от которых не зависит ни одна программа
# pacman -Scc - чистка кеша
```

Как? Вы наивно полагали, что на этом работа наша кончается? Э-э, батенька, впереди нас ждёт увлекательное путешествие, самое главное: [настройка arch.](arch-settings)

<div class="video"><iframe width="400" height="300" src="http://www.youtube.com/embed/D2N__iEWveo?rel=0" frameborder="0" allowfullscreen></iframe></div>
