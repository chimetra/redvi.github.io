<!DOCTYPE html>
<html lang="ru">
<head>
  <title>Как сделать pull request</title>
  <meta charset="utf-8">
  <meta name="description" content="Что такое pull request, зачем оно нужно и как его достичь.">  <meta name="author" content="redVi">  <meta name="viewport" content="initial-scale=1.0, width=device-width" />
  <link href="../theme/css/screen.css" rel="stylesheet" type="text/css" />
  <meta name='yandex-verification' content='494a81ecb0e796d6' />
  <link rel="icon" href="../favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
  <link href="../" type="application/atom+xml" rel="alternate" title="unix-lab.org ATOM Feed" />
  <link href="../feeds/rss.xml" type="application/rss+xml" rel="alternate" title="unix-lab.org RSS Feed" />
</head>
<body>
<div id="outer-wrapper">
<div id="header-wrapper">
    <a href=".."><div class="logo"></div></a>
    <div class="small">блог об операционных системах, open source и программировании</div>
<div class="nav">
        <ul>
      <li><a href="../archives.html">Архив</a></li>
      <li><a href="../about.html">О блоге</a></li>
      <li><a href="../authors.html">Экипаж</a></li>
    </ul>
</div>
</div>    <div id="main">
<h2><a href="../articles/pull-request.html">Как сделать pull request</a></h2>
<h5><i class="icon-feather"></i> 22 Август 2013 </h5>
<p>В продолжение серии коротких заметок, ибо длинные полотна писать, увы, недосуг. В узком кругу автора этих строк имеются товарищи весьма и весьма далёкие от мира железок, интернета и open source (в общем, они пропустили всё самое интересное). Не далее как на прошлой неделе угораздило таки употребить при них непотребное словосочетание &laquo;pull request&raquo;, после чего, ловя недоумённые взгляды, пришлось мяться и придумывать как сие получше перевести на великий и могучий. Увы, к взаимопониманию это не привело: попробую ответить здесь.</p>
<p><b>Pull Request</b> &mdash; запрос на включение. На включение написанного вами кода в чужой репозиторий.</p>
<h2>С чего начать?</h2>
<p>А для начала этот самый репозиторий нужно форкнуть (fork &mdash; вилка, ответвление). Разберём это нехитрое действо на примере веб-сервиса для хостинга IT-проектов, название которому GitHub. Разумеется, кроме GitHub есть и другие: BitBucket, например. Выбирать по вкусу.</p>
<p><u>Примечание:</u> для успешного проведения нижеизложенных операций у вас (что естественно) должен быть установлен git. Если это условие ещё не выполнено, шагом марш на <a href="github.html">вводное руководство</a>!</p>
<p>Заходим на страницу интересующего проекта, жмём кнопку <code>Fork</code>, ищем <u>на своей</u> странице URL для клонирования.</p>
<p><img alt="fork" src="../source/fork.jpg" title="fork on github" /></p>
<p>В консоли в зависимости от входных данных набираем нечто подобное:</p>
<div class="highlight"><pre><span class="gp">$</span> git clone git@github.com/username/django_documentation.git
</pre></div>


<p>Отлично. Уже можно вносить свои изменения в код проекта.</p>
<p>Тот репозиторий, что теперь лежит на вашем жёстком диске, независим от основного. В нём отслеживаются только ваши наработки. Но как следить за изменениями, происходящими в первоисточнике, откуда вы &laquo;стянули&raquo; репозиторий? Добавить удаленный репозиторий в отслеживаемые. Например, так:</p>
<div class="highlight"><pre><span class="gp">$</span> git remote -v
<span class="go">origin  git@github.com:username/django_documentation.git (fetch)</span>
<span class="go">origin  git@github.com:username/django_documentation.git (push)</span>
<span class="gp">$</span> git remote add upstream git@github.com:Alerion/django_documentation.git
</pre></div>


<p>После добавления <code>upstream</code> в отслеживаемые, наберите команду <code>git remote -v</code> ещё раз, вы должны увидеть произошедшие изменения.</p>
<p>Давайте посмотрим как сливать изменения из оригинального репозитория к себе в случае, если разработка в нём ушла вперёд пока вы сосредоточенно писали коммиты:</p>
<div class="highlight"><pre><span class="gp">$</span> git pull upstream master
<span class="go">From github.com:Alerion/django_documentation</span>
<span class="go">* branch            master     -&gt; FETCH_HEAD</span>
<span class="go">Updating 66f032e..062b294</span>
<span class="go">Fast-forward</span>
<span class="go">djbook/commands/authors.py                    | 65 ++--</span>
<span class="go">djbook/deps.txt                               |  6 ++--</span>
<span class="go">djbook/templates/authors.html                 | 14 ++--</span>
<span class="go">djbook/templates/base.html                    |  7 ++--</span>
<span class="go">locale/ru/LC_MESSAGES/faq/install.po          | 94 +++-</span>
<span class="go">locale/ru/LC_MESSAGES/faq/usage.po            | 49 +---</span>
<span class="go">locale/ru/LC_MESSAGES/howto/outputting-csv.po | 61 ++--</span>
<span class="go">locale/ru/LC_MESSAGES/topics/cache.po         | 77 ++--</span>
<span class="go">locale/ru/LC_MESSAGES/topics/db/multi-db.po   | 80 +++-</span>
<span class="go">9 files changed, 290 insertions(+), 163 deletions(-)</span>
</pre></div>


<p>У нас есть основной репозиторий &mdash; master и недавно добавленный нами upstream. Команда, данная выше, забирает всё новое из репозитория upstream и сливает изменения в master. Так, мы всегда можем получить последние наработки.</p>
<p>Вы можете также воспользоваться другой командой &mdash; <code>fetch</code> вместо указанной <code>pull</code>. В таком случае git заберет изменения с удаленного репозитория, но не будет пытаться слить их с вашей текущей веткой автоматически.</p>
<h2>Что такое ветки?</h2>
<p>Чаще всего ветки (branch &mdash; ответвление, ветвь, филиал) бывают тематическими. Например, при общей разработке, когда у всех участников есть право записи в репозиторий. В этом случае ветки используются для отделения изменений, сделанных одним из разработчиков, от общего репозитория. Ветки могут пригодиться и в случае с созданием pull-request'а.</p>
<p>Создание ветки происходит довольно просто. Находясь в каталоге с проектом, наберите следующие команды:</p>
<div class="highlight"><pre><span class="gp">$</span> git branch -a   <span class="c"># отобразить все ветки</span>
<span class="go">* master</span>
<span class="go">remotes/origin/1.4</span>
<span class="go">remotes/origin/HEAD -&gt; origin/master</span>
<span class="go">remotes/origin/master</span>
<span class="go">remotes/upstream/1.4</span>
<span class="go">remotes/upstream/master</span>
<span class="gp">$</span> git checkout -b new_branch <span class="c"># создать новую ветку, переключиться на неё</span>
</pre></div>


<p>Находясь в только что созданной ветке, вы можете приступить к работе. Вносите в код свои изменения, а когда закончите просто переключитесь обратно, к своей основной ветке. Вы можете отправить pull request, выбрав ветку <code>new_branch</code> или же прежде слить изменения из неё в основную ветку разработки. Рассмотрим это подробнее:</p>
<div class="highlight"><pre><span class="gp">$</span> git checkout master  <span class="c"># вернуться к основной ветке</span>
<span class="gp">$</span> git merge new_branch <span class="c"># слить изменения из new_branch</span>
</pre></div>


<p>Если нужно отправить в свой удалённый репозиторий вновь созданную ветку (не сливать её с master), делаем следующее:</p>
<div class="highlight"><pre><span class="gp">$</span> git push master new_branch
</pre></div>


<p>Не торопитесь сливать изменения. Если что-то не заладилось, созданную ветку можно удалить:</p>
<div class="highlight"><pre><span class="gp">$</span> git branch -d new_branch    <span class="c"># удалить локально</span>
<span class="gp">$</span> git push master :new_branch <span class="c"># и в удалённом репозитории</span>
</pre></div>


<h2>Отправляем изменения</h2>
<p>Добрались таки до ответа на поставленный вопрос: что такое pull request, зачем оно нужно и как его достичь. Как предложить владельцу репозитория свои изменения?</p>
<p>Для этого зайдите в свой аккаунт, выбирайте репозиторий владельца и ищите небольшую зелёную кнопку (на момент написания поста она была таковой, если даже что-то изменится, думаю, найти её будет несложно).</p>
<p>Перед тем как сделать запрос вы имеете возможность добавить комментарий, просмотреть то, какие файлы будут изменены, какие коммиты добавлены. В верхнем углу окна добавления запроса обратите внимание откуда куда и что вы сливаете. Если необходимо слить основные ветки выбор падёт на репозиторий <code>username:master</code>, если отдельную ветку (вспоминаем branch) &mdash; так и указывайте её.</p>
<p><a href="../source/change-and-comment.jpg" data-lighter><img src="../source/change-and-comment.jpg"/></a></p>
<p>А дальше... ждать. Пока придёт владелец оригинального репозитория и примет/отклонит ваши изменения.</p>
<p>Ну вот, мы его достигли. Просветления то есть :)</p>
<h2>А подробнее?</h2>
<p>Ну, что ещё? Применительно к github'у можно отметить факт наличия у них <b>Issues</b>. Это такая &laquo;примочка&raquo;, благодаря которой можно ставить задачи для проекта, давать им описание и метку, определяющую к какому разряду данная задача относится (закрытие бага или написание фичи), а ещё назначать ответственного за выполнение определённого <b>issue</b>: всё как у больших.</p>
<p>Итогов подводить не стану. Для заинтересованных лиц ссылочка на хорошую книгу: <a href="http://cloud.github.com/downloads/GArik/progit/progit.ru.pdf">Pro Git pdf</a></p>
<p><u>Примечание:</u> указанному в примере <a href="https://github.com/Alerion/django_documentation" rel="noindex, nofollow">репозиторию</a> требуется влить кубометр свежей крови. Присоединяйтесь к переводу документации.</p>
<h5><i class="icon-user"></i> <a href="../author/redvi.html">redVi</a>,
<i class="icon-bookmarks"></i> <a href="../tag/git.html">Git</a> /
</h5>
<p align="center"><a href="#">наверх</a></p>
</div>
<div id="footer-wrapper">
<ul class="footer">
       <li class="footer"><a href="../tag/android.html">Android&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/arch.html">Arch&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/blog.html">Blog&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/debian.html">Debian&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/decorations.html">Decorations&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/django.html">Django&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/editors.html">Editors&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/gentoo.html">Gentoo&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/git.html">Git&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/javascript.html">JavaScript&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/kernel.html">Kernel&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/latex.html">LaTeX&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/python.html">Python&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/server.html">Server&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/web.html">Web&nbsp;&bull;&nbsp;</a></li>
       <li class="footer"><a href="../tag/windows.html">Windows&nbsp;&bull;&nbsp;</a></li>
  </ul>
<br/><p>&copy;&nbsp;2011&mdash;2013&nbsp;&bull;&nbsp;<a href="..">unix-lab.org </a>&nbsp;&bull;&nbsp;powered by <a href="https://github.com/getpelican">pelican</a>&nbsp;&bull;&nbsp;<a href="http://creativecommons.org/licenses/by-nc/3.0/deed.ru">CC BY-NC</a></p>
</div>
<!-- end #footer --></div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42400517-1', 'www.unix-lab.org');
  ga('send', 'pageview');

</script>
</body>
</html>