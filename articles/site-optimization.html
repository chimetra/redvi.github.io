<!DOCTYPE html>
<html lang="ru">
<head>
  <title>Со скоростью света или Игра в оптимизаторы</title>
  <meta charset="utf-8">
  <meta name="description" content="На этот раз предлагается поговорить об оптимизации. Это дело серьёзное и требует особого к себе внимания.">  <meta name="author" content="redVi">  <meta name="viewport" content="initial-scale=1.0, width=device-width" />
  <link href="http://www.unix-lab.org/theme/css/screen.css" rel="stylesheet" type="text/css" />
  <meta name='yandex-verification' content='494a81ecb0e796d6' />
  <link rel="icon" href="http://www.unix-lab.org/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="http://www.unix-lab.org/favicon.ico" type="image/x-icon">
  <link href="http://www.unix-lab.org/" type="application/atom+xml" rel="alternate" title="unix-lab.org ATOM Feed" />
  <link href="http://www.unix-lab.org/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="unix-lab.org RSS Feed" />
</head>
<body>
<div id="outer-wrapper">
<div id="header-wrapper">
    <a href="http://www.unix-lab.org"><div class="logo"></div></a>
    <div class="small">блог об операционных системах, open source и программировании</div>
<div class="nav">
        <ul>
      <li><a href="http://www.unix-lab.org/archives.html">Архив</a></li>
      <li><a href="http://www.unix-lab.org/about.html">О блоге</a></li>
      <li><a href="http://www.unix-lab.org/authors.html">Экипаж</a></li>
    </ul>
</div>
</div>    <div id="main">
<h2><a href="http://www.unix-lab.org/articles/site-optimization.html">Со скоростью света или Игра в оптимизаторы</a></h2>
<h5><i class="icon-feather"></i> 17 Август 2013 </h5>
<p>На этот раз предлагается поговорить об оптимизации. Это дело серьёзное и требует особого к себе внимания. Несмотря на распространение этих ваших интернетов в каждый дом и в каждую квартиру (автор помнит времена, когда для подключения к глобальной паутине приходилось брать карту СТК за 150 российских рублей: страницы загружались неимоверно медленно, а рубли расходовались неимоверно быстро) не у всех наших граждан имеется быстрый интернет-канал, а некоторые товарищи и вовсе пользуются исключительно &laquo;мобильным интернетом&raquo;.</p>
<p>Не будем забывать о движках различной степени тяжести (Drupal, Wordpress, Joomla!, etc). Впротивовес <a href="pelican.html">статическим сайтам</a>, которые подойдут далеко не всем блоггерам/сайтостроителям, они достаточно тяжелы изначально и посему требуют непременной доработки в плане оптимизации самих себя.</p>
<p>Что же, наверняка у нас имеется лучшее решение нежели просто ждать пока загрузится наша страница.</p>
<p>Приступим к разбору полётов. Поскольку использовать указанные ниже сервисы приходится нечасто и по прошествии времени мозг начинает задействовать свою неповторимую функцию &mdash; способность забывать &mdash; здесь будут оставлены проверенные временем онлайн-сервисы, способствующие <s>повышению ЧСВ оптимизатора</s> ускорению загрузки страниц вашего сайта.</p>
<h3>Со скоростью света</h3>
<p>Сначала сто&#x301;ит проанализировать какое количество времени занимает загрузка страниц и что мешает загружаться быстрее. Как правило, это неоптимизированные изображения, javascript, CSS. Что и почему расскажет <a href="http://developers.google.com/speed/pagespeed/insights/">Page Speed Online от Google</a>. Ели не нравится, вполне можно положиться на <a href="http://tools.pingdom.com/fpt/">Pingdom</a>.</p>
<p><a href="../source/page-speed.jpg" data-lighter><img src="../source/page-speed.jpg"/></a></p>
<p>После проверки можно обратиться к <u>PageSpeed Optimization Products</u> от того же Google:</p>
<p><code>https://developers.google.com/speed/pagespeed/optimization</code>.</p>
<h3>Сервисы для оптимизации CSS-кода</h3>
<p>Как правило, подобные сервисы делают свою работу очень неплохо и сокращают размер CSS-файла процентов на 30. Или больше, если в коде проставлено множество строк с копирайтами, пробелами, прочими радостями. Печаль одна: неудобоваримая каша, которая получается из кода. Весь код вставляется в одну лишь строку, поэтому яростно боритесь с желанием впоследствие изменить свойство какого-нибудь элемента: вы убьёте массу сил, пытаясь разргести этот сжатый бедлам.</p>
<p>Можно поступить иначе: иметь под рукой код неоптимизированный, дабы при случае подправить что-то в нём, а затем снова прогнать через сервис. Или прогонять лишь те участки кода, которые менять вы ну никогда уже не станете.</p>
<p><b>Robson CSS Compressor</b></p>
<p>Вещь прекрасная, ставится на первое место в нашем маленьком рейтинге. Заоптимизирует CSS по самое не горюй, что и требуется. Адрес этой хорошей вещи:</p>
<p><code>http://iceyboard.no-ip.org/projects/css_compressor</code></p>
<p>Кандидат номер два <b>CleanCSS</b>.</p>
<p>Склонен к балансу между оптимизацией и удобочитаемостью. Пригодится в случае, если сайт не ваш, а сделан для сдачи заказчику, например. Или ежели планируется, что после вас этот код будет сопровождать кто-то другой. Адрес:</p>
<p><code>http://www.cleancss.com/</code></p>
<p>Наиболее страшен <b>Tabifier</b> в силу своей всеядности: эта штука понимает также и HTML. Для товарищей особенно замороченных на оптимизации рекомендуется:</p>
<p><code>http://tools.arantius.com/tabifier</code></p>
<p>В целом, подобных сервисов имеется внушительное количество. Но нам хватит и этих трёх.</p>
<h3>Сжимаем JavaScript</h3>
<p>Можно было бы включить YUI Compressor, но, раз уж мы говорим лишь об онлайн-сервисах, возьму на себя ответственность порекомендовать только один из них, так сказать самый-самый. Это снова Google со своим <b>Closure Compiler</b>:</p>
<p><code>http://closure-compiler.appspot.com/home</code></p>
<p>Конечно, наилучший метод оптимизации javascript &mdash; неиспользование javascript ;)</p>
<h3>Долой изображения! Да здравствуют шрифты!</h3>
<p>Обычно изображения загружаются дольше, чем шрифты или стили. Много мелких изображений и вообще сейчас моветон. А не заменить ли их чем получше? Например, модными шрифтами. <b>Fontello</b> спешит на помощь.</p>
<p>На странице проекта <code>http://fontello.com/</code> вам будет предложено выбрать несколько шрифтов-кнопок по вкусу. Также сразу нужно обратить внимание на настройки, они поистине замечательны. У вас есть возможность выбрать размер шрифта, при надобности указать CSS-префикс и даже кодировку. После того, как разберётесь с этими настройками, кликом начинайте выбирать нужные шрифты. Их упакуют в архив вместе с примером, разнообразными CSS-стилями, HOWTO и demo-страницей, призванной показать как оно будет выглядеть. А выглядит оно очень недурно. На буржуинских сайтах используется довольно часто в то время как на большинстве отечественных по какой-то неведомой автору причине предпочитают таки иметь дело с изображениями.</p>
<h3>Или оптимизируем изображения</h3>
<p><b>Yahoo Smush.it</b> рулит и педалит. Позволяет сжимать изображения практически без потери качества. Картинки, которые планируется подвергнуть эксперименту, можно загружать как с жёсткого диска своей машины так и указывать к ним URL-путь. На выходе вам сообщат исходный размер и размер сжатого изображения, а также позволят загрузить архив, его содержащий. Действительно сто&#x301;ящий сервис, использую не первый год, нареканий нет.</p>
<p><code>http://www.smushit.com/ysmush.it/</code></p>
<p>Как правило, первыми кандидатами на сжатие становятся такие константы (в том смысле, что они неизменяемы) как всевозможные элементы самого веб-сайта: шапка, кнопки... Хотя если не лениться, можно прогонять и отдельные изображения для статей.</p>
<p>Но в некоторых случаях требуется ещё более жёсткий подход. Если страница просто ломится от картинок (пример: объёмный пост со множеством изображений или галерея какая-нибудь), полная загрузка её может занимать достаточно продолжительное время. Дабы избежать этого неприятного момента, можно загружать картинки лишь тогда, когда взор читателя обратится к ним.</p>
<p>В этом посильную помощь нам окажет один из скриптов с сайта jquery.com: <code>http://plugins.jquery.com/lazyload/</code>. Для его использования придётся подключить jquery:</p>
<div class="highlight"><pre><span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&#39;http://code.jquery.com/jquery-2.0.3.min.js&#39;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&#39;путь_к_скрипту.js&#39;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="c">&lt;!--вызов функции скрипта--&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;img.lazy&quot;</span><span class="p">).</span><span class="nx">lazyload</span><span class="p">({</span>
    <span class="nx">effect</span> <span class="o">:</span> <span class="s2">&quot;fadeIn&quot;</span>
    <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
</pre></div>


<p>Чтобы это сработало, изображению нужно присвоить класс <code>.lazy</code>:</p>
<div class="highlight"><pre> <span class="o">&lt;</span><span class="n">img</span> <span class="n">class</span><span class="o">=</span><span class="s">&quot;lazy&quot;</span> <span class="n">src</span><span class="o">=</span><span class="s">&quot;img.gif&quot;</span> <span class="n">data</span><span class="o">-</span><span class="n">original</span><span class="o">=</span><span class="s">&quot;example.jpg&quot;</span><span class="o">&gt;</span>
</pre></div>


<p>Вот и всё. До связи!</p>
<h5><i class="icon-user"></i> <a href="http://www.unix-lab.org/author/redvi.html">redVi</a>,
<i class="icon-bookmarks"></i> <a href="http://www.unix-lab.org/tag/web.html">Web</a> /
<a href="http://www.unix-lab.org/tag/blog.html">Blog</a> /
</h5>
<p align="center"><a href="#">наверх</a></p>
</div>
</div>
<div id="footer-wrapper">
<ul class="footer">
       <li class="footer"><a href="http://www.unix-lab.org/tag/android.html">Android&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/arch.html">Arch&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/blog.html">Blog&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/debian.html">Debian&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/decorations.html">Decorations&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/django.html">Django&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/editors.html">Editors&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/gentoo.html">Gentoo&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/git.html">Git&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/javascript.html">JavaScript&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/kernel.html">Kernel&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/latex.html">LaTeX&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/linux.html">Linux&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/python.html">Python&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/server.html">Server&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/web.html">Web&nbsp;&bull;</a></li>
       <li class="footer"><a href="http://www.unix-lab.org/tag/windows.html">Windows&nbsp;&bull;</a></li>
  </ul><ul class="footer">
    <li class="footer">&copy;&nbsp;2011&mdash;2013&nbsp;::</li>
    <li class="footer"><a href="http://www.unix-lab.org">unix-lab.org </a>&nbsp;::</li>
    <li class="footer">powered by <a href="https://github.com/getpelican">pelican</a>&nbsp;::</li>
    <li class="footer"><a href="http://creativecommons.org/licenses/by-nc/3.0/deed.ru">CC BY-NC</a></li>
</ul>
</div><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42400517-1', 'www.unix-lab.org');
  ga('send', 'pageview');

</script>
</body>
</html>