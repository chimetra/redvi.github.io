<!DOCTYPE html>
<html lang="ru">
<head>

  <title>DWM: тайлинг — наше всё | UNIX-LAB.ORG</title>
  <meta name="description" content="Настройка тайлового менеджера окон DWM">

  <meta charset="utf-8">
  <meta name="author" content="redVi">
  <meta name="viewport" content="initial-scale=1.0, width=device-width" />
  <link rel="icon" href="http://jekyll-unixlab.rhcloud.com/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="http://jekyll-unixlab.rhcloud.com/favicon.ico" type="image/x-icon">
  <link href="http://jekyll-unixlab.rhcloud.com/assets/stylesheets/screen.css" rel="stylesheet" type="text/css" />
  <link rel="alternate" type="application/atom+xml" title="UNIX-LAB.ORG" href="http://jekyll-unixlab.rhcloud.com/feeds/atom.xml">
  <link rel="alternate" type="application/rss+xml" title="UNIX-LAB.ORG" href="http://jekyll-unixlab.rhcloud.com/feeds/rss.xml">
</head>
<body>
<div id="outer-wrapper">
<div id="header-wrapper">
    <a href="/"><div class="logo"></div></a>
    <div class="small">блог об операционных системах, open source и программировании</div>
<div class="nav">
  <ul>
    <li><a href="/archive/">Архив</a></li>
    <li><a href="/about/">О блоге</a></li>
    <li><a href="/author/">Автор</a></li>
  </ul>
</div>
</div>

<div id="main">
<h2>DWM: тайлинг — наше всё</h2>
<h5><i class="icon-feather"></i> 04 декабря 2012

 <i class="icon-bookmarks"></i>

<a href="/tags/decorations.html">Decorations /</a>

<a href="/tags/arch.html">Arch /</a>

<a href="/tags/linux.html">Linux /</a>

</h5>

<p>Ну чем можно заняться линуксоиду, у которого в системе всё, решительно всё работает? Конечно же, довести до ума свой оконный менеджер. Или попробовать новый.</p>

<p>К примеру, dwm — динамический фреймовый оконный менеджер. Написан на языке C. Настройка производится посредством правки заголовочного файла, для чего необходимо иметь исходники dwm. Если вас не пугает перспектива потратить час-другой на настройку этой штуки под свои нужды, то давайте приступим.</p>

<h2 id="toc_0">Где взять?</h2>

<p>Если ваш дистрибутив — ArchLinux, ставьте вместе с автором сего поста <code>abs</code> — это наилучшее решение, так вы будете иметь возможность внести свои правки в конфигурационный файл dwm - сделать всё по-своему, а затем установить то, что получилось. Обладатели других дистрибутивов могут найти исходники dwm и загрузить их. Например, с сайта <a href="http://dwm.suckless.org/">http://dwm.suckless.org/</a> - вкладка <code>downloads</code>.</p>

<p>Метода арча:</p>
<div class="highlight"><pre><code class="console language-console" data-lang="console"><span class="gp">#</span> pacman -S abs
<span class="gp">#</span> vim /etc/abs.conf
</code></pre></div>
<p>Здесь поменяем каталог <code>/var/abs</code> на какой-нибудь другой. Можно оставить по-умолчанию, но тогда все исходники лягут в директорию <code>/var</code>, что не есть хорошо, если под содержащий её раздел выделено мало места.</p>

<p>Пример настройки:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="c"># /etc/abs.conf</span>
<span class="c"># the top-level directory of all your PKGBUILDs</span>
<span class="o">[</span> <span class="s2">&quot;$ABSROOT&quot;</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">ABSROOT</span><span class="o">=</span><span class="s2">&quot;/home/user/abs/&quot;</span>
</code></pre></div>
<p>Синхронизируем дерево abs:</p>
<div class="highlight"><pre><code class="console language-console" data-lang="console"><span class="gp">#</span> abs
<span class="go">==&gt; Starting ABS sync...</span>
<span class="go">receiving file list ... done</span>
<span class="go">./</span>
<span class="go">community/python-memcached/PKGBUILD</span>
<span class="go">core/</span>
<span class="go">multilib/</span>
<span class="go">multilib/binutils-multilib/</span>
<span class="go">multilib/binutils-multilib/PKGBUILD</span>
<span class="go">multilib/binutils-multilib/binutils.install</span>
</code></pre></div>
<p>Если вам не нужна вся коллекция <code>abs</code>, можно получить только dwm:</p>
<div class="highlight"><pre><code class="console language-console" data-lang="console"><span class="gp">#</span> abs community/dwm/
</code></pre></div>
<p>Отлично. Теперь находим dwm и начинаем разбираться с его настройкой. Перейдите в нужную директорию</p>
<div class="highlight"><pre><code class="console language-console" data-lang="console"><span class="gp">$</span> <span class="nb">cd</span> /home/user/abs/community/dwm
</code></pre></div>
<p>Вносим нужные правки (об этом ниже) и собираем пакет для установки. Но постойте-ка! Мы ведь нарушим целостность файла, изменив его, соответственно, не пройдём проверку на контрольные суммы. Что ж, давайте отключим эту проверку. Итак, установка:</p>
<div class="highlight"><pre><code class="console language-console" data-lang="console"><span class="gp">$</span> sudo makepkg --skipchecksums --asroot
</code></pre></div>
<p>Добавьте в ваш <code>.xinitrc</code> запись</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">exec dwm
</code></pre></div>
<p>И входите по startx - добро пожаловать!</p>

<p>Можно приступать к настройке, но... прежде позвольте разжечь ваш аппетит. Давайте посмотрим, что мы можем получить в итоге. Прежде всего тайловые wm проповедуют принцип &quot;ничего лишнего&quot;:</p>

<p><a href="http://farm3.staticflickr.com/2889/9263499596_54c76c71a6_b.jpg" data-lighter><img src="http://farm3.staticflickr.com/2889/9263499596_54c76c71a6_b.jpg"/></a></p>

<h2 id="toc_1">Как настроить ?</h2>

<p>Посмотрим, что можно изменить в файле <code>config.h</code></p>

<p>В первую очередь это шрифт. Здесь нужно чуть изменить настройки, поскольку в противном случае в статус-баре будут забавные &quot;кракозябры&quot; вместо кириллицы.</p>

<p>Для определения поддержки тем или иным шрифтом кириллицы, используйте утилиту <code>xfontsel</code>.</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">font</span><span class="p">[]</span><span class="o">=</span> <span class="s">&quot;-*-dejavu sans-medium-r-*-*-8-*-*-*-*-*-*-ru&quot;</span><span class="p">;</span>
</code></pre></div>
<p>Вам может потребоваться явно указать пути к шрифтам в файле <code>/etc/X11/xorg.conf</code>:</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="n">Section</span> <span class="s">&quot;Files&quot;</span>
    <span class="n">FontPath</span> <span class="s">&quot;/usr/share/fonts/local&quot;</span>
    <span class="n">FontPath</span> <span class="s">&quot;/usr/share/fonts/misc&quot;</span>
    <span class="n">FontPath</span> <span class="s">&quot;/usr/share/fonts/cyrillic&quot;</span>
<span class="n">EndSection</span>
</code></pre></div>
<p>Далее идёт настройка цветов статус-бара:</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">normbordercolor</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;#8181ff&quot;</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">normbgcolor</span><span class="p">[]</span>     <span class="o">=</span> <span class="s">&quot;#222222&quot;</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">normfgcolor</span><span class="p">[]</span>     <span class="o">=</span> <span class="s">&quot;#bbbbbb&quot;</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">selbordercolor</span><span class="p">[]</span>  <span class="o">=</span> <span class="s">&quot;#4e4eff&quot;</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">selbgcolor</span><span class="p">[]</span>      <span class="o">=</span> <span class="s">&quot;#606060&quot;</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">selfgcolor</span><span class="p">[]</span>      <span class="o">=</span> <span class="s">&quot;#eeeeee&quot;</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">borderpx</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">snap</span>      <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">Bool</span> <span class="n">showbar</span>           <span class="o">=</span> <span class="n">True</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">Bool</span> <span class="n">topbar</span>            <span class="o">=</span> <span class="n">True</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>normbordercolorp[] = цвет границ окна</li>
<li>normbgcolor[] = цвет фона</li>
<li>normfgcolor[] = цвет текста в статус-баре</li>
<li>selbordercolor[] = цвет границ активного окна</li>
<li>selbgcolor[] = цвет фона заголовка окна</li>
<li>selfgcolor[] = цвет текста заголовка окна</li>
<li>borderpx = ширина границ окна</li>
</ul>

<p>Настроим как нам нравится наши теги (это что-то вроде рабочих столов в других менеджерах окон)</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">tags</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;term&quot;</span><span class="p">,</span> <span class="s">&quot;chat&quot;</span><span class="p">,</span> <span class="s">&quot;www&quot;</span><span class="p">,</span> <span class="s">&quot;media&quot;</span><span class="p">,</span> <span class="s">&quot;work&quot;</span> <span class="p">};</span>
</code></pre></div>
<p>Теперь вместо цифр мы имеем человекопонятные обозначения для каждого тега.</p>

<p>Как и во всех — мне известных — оконных менеджерах, dwm использует клавишу-модификатор. По умолчанию это <code>Mod1Mask</code> — то есть клавиша <code>Alt</code>. Чтобы изменить её на клавишу <code>super</code> (там, где лого windows) — изменим запись <code>#define MODKEY</code>:</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="cm">/* key definitions */</span>
<span class="cp">#define MODKEY Mod4Mask</span>
<span class="cp">#define TAGKEYS(KEY,TAG)</span>
<span class="p">{</span> <span class="n">MODKEY</span><span class="p">,</span>          <span class="n">KEY</span><span class="p">,</span>      <span class="n">view</span><span class="p">,</span>   <span class="p">.</span><span class="n">ui</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">TAG</span><span class="p">}</span> <span class="p">},</span> \
<span class="p">{</span> <span class="n">MODKEY</span><span class="o">|</span><span class="n">ControlMask</span><span class="p">,</span>  <span class="n">KEY</span><span class="p">,</span>      <span class="n">toggleview</span><span class="p">,{.</span><span class="n">ui</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">TAG</span><span class="p">}</span> <span class="p">},</span> \
<span class="p">{</span> <span class="n">MODKEY</span><span class="o">|</span><span class="n">ShiftMask</span><span class="p">,</span>   <span class="n">KEY</span><span class="p">,</span>      <span class="n">tag</span><span class="p">,</span>  <span class="p">{.</span><span class="n">ui</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">TAG</span><span class="p">}</span> <span class="p">},</span> \
<span class="p">{</span> <span class="n">MODKEY</span><span class="o">|</span><span class="n">ControlMask</span><span class="o">|</span><span class="n">ShiftMask</span><span class="p">,</span> <span class="n">KEY</span><span class="p">,</span>   <span class="n">toggletag</span><span class="p">,</span> <span class="p">{.</span><span class="n">ui</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">TAG</span><span class="p">}</span> <span class="p">},</span>
</code></pre></div>
<p>Настройка горячих клавиш. Из приведённого ниже кода ясно, что нажатие <code>клавиши-модификатора + p</code> вызовет <code>dmenu</code>, нажатие <code>клавиши-модификатора + Return</code> (Enter) вызовет эмулятор терминала, ну и так далее. В принципе, стандартные обозначения вполне даже удобны и вряд ли вам захочется их менять. Мы вернёмся к этому чуть позже, далее будет приведён более полный перечень горячих клавиш.</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="k">static</span> <span class="n">Key</span> <span class="n">keys</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
 <span class="cm">/* modifier            key        function        argument */</span>
<span class="p">{</span> <span class="n">MODKEY</span><span class="p">,</span>              <span class="n">XK_p</span><span class="p">,</span>      <span class="n">spawn</span><span class="p">,</span>     <span class="p">{.</span><span class="n">v</span> <span class="o">=</span> <span class="n">dmenucmd</span> <span class="p">}</span> <span class="p">},</span>
<span class="p">{</span> <span class="n">MODKEY</span><span class="p">,</span>              <span class="n">XK_Return</span><span class="p">,</span> <span class="n">spawn</span><span class="p">,</span>  <span class="p">{.</span><span class="n">v</span> <span class="o">=</span> <span class="n">termcmd</span> <span class="p">}</span> <span class="p">},</span>
<span class="p">{</span> <span class="n">MODKEY</span><span class="p">,</span>              <span class="n">XK_b</span><span class="p">,</span>      <span class="n">togglebar</span><span class="p">,</span>  <span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="p">},</span>
<span class="p">{</span> <span class="n">MODKEY</span><span class="p">,</span>              <span class="n">XK_j</span><span class="p">,</span>      <span class="n">focusstack</span><span class="p">,</span>  <span class="p">{.</span><span class="n">i</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
<span class="p">{</span> <span class="n">MODKEY</span><span class="p">,</span>              <span class="n">XK_k</span><span class="p">,</span>      <span class="n">focusstack</span><span class="p">,</span>  <span class="p">{.</span><span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>

<span class="p">}</span>
</code></pre></div>
<p>Настройка правил для приложений</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="k">static</span> <span class="k">const</span> <span class="n">Rule</span> <span class="n">rules</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>

<span class="cm">/* class      instance    title       tags mask     isfloating   monitor */</span>
<span class="p">{</span> <span class="s">&quot;Gimp&quot;</span><span class="p">,</span>     <span class="nb">NULL</span><span class="p">,</span>       <span class="nb">NULL</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span>            <span class="n">True</span><span class="p">,</span>        <span class="o">-</span><span class="mi">1</span> <span class="p">},</span>
<span class="p">{</span> <span class="s">&quot;Firefox&quot;</span><span class="p">,</span>  <span class="nb">NULL</span><span class="p">,</span>       <span class="nb">NULL</span><span class="p">,</span>       <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span>       <span class="n">False</span><span class="p">,</span>       <span class="o">-</span><span class="mi">1</span> <span class="p">},</span>

<span class="p">};</span>
</code></pre></div>
<p>~0 - приложение будет запускаться сразу на всех тегах. Это может быть удобно для какого-нибудь док-бара, трея и прочих</p>

<p>1 &lt;&lt; 0 — запуск на первом теге 1 &lt;&lt; 2 — запуск на третьем теге 1 &lt;&lt; 3 — запуск на четвертом теге и так далее</p>

<p><code>isfloating</code> указывает на то, будут ли окна приложения плавающими</p>

<h2 id="toc_2">Расположение окон. Горячие клавиши</h2>

<p>По умолчанию DWM поддерживает три режима расположения окон, плиточный []= , монокль [M] ,  плавающий &gt;&lt;&gt;. Как правило, этого бывает достаточно.</p>

<p>По умолчанию при запуске dwm отображается плиточный режим окон. Чтобы поставить вместо него свой любимый режим, просто найдите нижеуказанные строки и поставьте нужный режим на первое место:</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="k">static</span> <span class="k">const</span> <span class="n">Layout</span> <span class="n">layouts</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>

<span class="cm">/* symbol     arrange function */</span>
<span class="p">{</span> <span class="s">&quot;&gt;&lt;&gt;&quot;</span><span class="p">,</span>      <span class="nb">NULL</span> <span class="p">},</span>
<span class="p">{</span> <span class="s">&quot;[]=&quot;</span><span class="p">,</span>      <span class="n">tile</span> <span class="p">},</span>
<span class="p">{</span> <span class="s">&quot;[M]&quot;</span><span class="p">,</span>      <span class="n">monocle</span> <span class="p">},</span>
<span class="p">};</span>
</code></pre></div>
<p><a href="http://fc05.deviantart.net/fs70/i/2013/001/d/e/arch_linux__dwm__december_2012_by_redvi9-d5pkhy7.png" data-lighter><img src="http://fc05.deviantart.net/fs70/i/2013/001/d/e/arch_linux__dwm__december_2012_by_redvi9-d5pkhy7.png"/></a></p>

<p>Сочетание горячих клавиш с модификацией MODKEY у нас получилось таким:</p>

<p><code>Super + M</code> - монокль</p>

<p><code>Super + T</code> - плитка</p>

<p><code>Super + F</code> - плавающие окна</p>

<p><code>Super + N</code> - перейти на тег, N - номер тега</p>

<p><code>Super + p</code> - dmenu, если установлено</p>

<p><code>Super + Shift + q</code> - выход из dwm</p>

<p><code>Super + Shift + N</code> - перенести окно на соответствующий тег</p>

<p><code>Super + Shift + C</code> - закрыть окно</p>

<p><code>Super + K</code> - переход на неактивное окно</p>

<p><code>Super + J</code> - то же самое, в общем перемещение между окнами</p>

<p><code>Alt + Tab</code> - переход на следующий/предыдущий тег</p>

<h2 id="toc_3">Дополнительные плюшки и запуск</h2>

<p>У dwm нет каких-либо специальных настроек для запуска приложений. Всё, что запускал ваш openbox (верно?) из файла <code>autostart</code>, прописывается просто в <code>.xinitrc</code></p>

<p>Например:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">nitrogen --restore
xmodmap ~/.xmodmaprc
conky | while read -r; do xsetroot -name &quot;$REPLY&quot;; done &amp;
и прочее...
</code></pre></div>
<p>Естественно, если вы пожелаете отображать информацию из conky, нужно будет сделать его покороче ;) Так, чтобы он вмещался в статус-бар dwm.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">.conkyrc:

out_to_x no
out_to_console yes
background no
update_interval 100
total_run_times 0
TEXT
CPU ${cpu cpu0}% :: Mem $mem :: HDD ${fs_used} :: ${totaldown eth0} / ${totalup eth0} :: ${time %d:%m:%H:%M}
</code></pre></div>
<p>Вот, пожалуй, и всё. Пусть dwm принесёт вам немало радостных минут,  позволит забыть о мыши и в целом сделает вашу работу за компьютером удобнее.
Настройки wdm автора можно найти на <a href="https://github.com/redVi/dotfiles/tree/master/dwm">github</a> вместе с инструкцией по применению ;)</p>


<br />
<p align="center"><a href="#">наверх</a></p>


</div>
</div>
<div id="footer-wrapper">
<ul class="footer">
   <a href="/tags/android.html" class="set-1">android</a> <a href="/tags/arch.html" class="set-3">arch</a> <a href="/tags/blog.html" class="set-1">blog</a> <a href="/tags/debian.html" class="set-1">debian</a> <a href="/tags/decorations.html" class="set-1">decorations</a> <a href="/tags/editors.html" class="set-1">editors</a> <a href="/tags/gentoo.html" class="set-1">gentoo</a> <a href="/tags/git.html" class="set-1">git</a> <a href="/tags/kernel.html" class="set-1">kernel</a> <a href="/tags/latex.html" class="set-1">latex</a> <a href="/tags/linux.html" class="set-5">linux</a> <a href="/tags/python.html" class="set-2">python</a> <a href="/tags/ruby.html" class="set-1">ruby</a> <a href="/tags/server.html" class="set-2">server</a> <a href="/tags/web.html" class="set-1">web</a> <a href="/tags/windows.html" class="set-1">windows</a>
</ul>
<ul class="footer">
    <li class="footer">&copy;&nbsp;2011&mdash;2013&nbsp;::</li>
    <li class="footer"><a href="/">unix-lab.org</a>&nbsp;::</li>
    <li class="footer">licensed under <a href="http://creativecommons.org/licenses/by-nc/3.0/deed.ru">CC BY-NC</a></li>
</ul>
</div>

</body>
</html>
