---
layout: post
title: Со скоростью света или Игра в оптимизаторы
date: 2013-08-17 00:05
tags: [web]
slug: site-optimization
author: redVi
summary: На этот раз предлагается поговорить об оптимизации. Это дело серьёзное и требует особого к себе внимания.
---

На этот раз предлагается поговорить об оптимизации. Это дело серьёзное и требует особого к себе внимания. Несмотря на распространение этих ваших интернетов в каждый дом и в каждую квартиру (автор помнит времена, когда для подключения к глобальной паутине приходилось брать карту СТК за 150 российских рублей: страницы загружались неимоверно медленно, а рубли расходовались неимоверно быстро) не у всех наших граждан имеется быстрый интернет-канал, а некоторые товарищи и вовсе пользуются исключительно &laquo;мобильным интернетом&raquo;.

Не будем забывать о движках различной степени тяжести (Drupal, Wordpress, Joomla!, etc). Впротивовес [статическим сайтам](http://www.unix-lab.org/posts/pelican/), которые подойдут далеко не всем блоггерам/сайтостроителям, они достаточно тяжелы изначально и посему требуют непременной доработки в плане оптимизации самих себя.

Что же, наверняка у нас имеется лучшее решение нежели просто ждать пока загрузится наша страница.

Приступим к разбору полётов. Поскольку использовать указанные ниже сервисы приходится нечасто и по прошествии времени мозг начинает задействовать свою неповторимую функцию &mdash; способность забывать &mdash; здесь будут оставлены проверенные временем онлайн-сервисы, способствующие <s>повышению ЧСВ оптимизатора</s> ускорению загрузки страниц вашего сайта.

### Со скоростью света

Сначала сто&#x301;ит проанализировать какое количество времени занимает загрузка страниц и что мешает загружаться быстрее. Как правило, это неоптимизированные изображения, javascript, CSS. Что и почему расскажет [Page Speed Online от Google](http://developers.google.com/speed/pagespeed/insights/). Ели не нравится, вполне можно положиться на [Pingdom](http://tools.pingdom.com/fpt/).

![page speed](http://www.unix-lab.org/source/page-speed.jpg)

После проверки можно обратиться к <u>PageSpeed Optimization Products</u> от того же Google:

`https://developers.google.com/speed/pagespeed/optimization`.

### Сервисы для оптимизации CSS-кода

Как правило, подобные сервисы делают свою работу очень неплохо и сокращают размер CSS-файла процентов на 30. Или больше, если в коде проставлено множество строк с копирайтами, пробелами, прочими радостями. Печаль одна: неудобоваримая каша, которая получается из кода. Весь код вставляется в одну лишь строку, поэтому яростно боритесь с желанием впоследствие изменить свойство какого-нибудь элемента: вы убьёте массу сил, пытаясь разргести этот сжатый бедлам.

Можно поступить иначе: иметь под рукой код неоптимизированный, дабы при случае подправить что-то в нём, а затем снова прогнать через сервис. Или прогонять лишь те участки кода, которые менять вы ну никогда уже не станете.

<b>Robson CSS Compressor</b>

Вещь прекрасная, ставится на первое место в нашем маленьком рейтинге. Заоптимизирует CSS по самое не горюй, что и требуется. Адрес этой хорошей вещи:

`http://iceyboard.no-ip.org/projects/css_compressor`

Кандидат номер два <b>CleanCSS</b>.

Склонен к балансу между оптимизацией и удобочитаемостью. Пригодится в случае, если сайт не ваш, а сделан для сдачи заказчику, например. Или ежели планируется, что после вас этот код будет сопровождать кто-то другой. Адрес:

`http://www.cleancss.com/`

Наиболее страшен <b>Tabifier</b> в силу своей всеядности: эта штука понимает также и HTML. Для товарищей особенно замороченных на оптимизации рекомендуется:

`http://tools.arantius.com/tabifier`

В целом, подобных сервисов имеется внушительное количество. Но нам хватит и этих трёх.

### Сжимаем JavaScript

Можно было бы включить YUI Compressor, но, раз уж мы говорим лишь об онлайн-сервисах, возьму на себя ответственность порекомендовать только один из них, так сказать самый-самый. Это снова Google со своим <b>Closure Compiler</b>:

`http://closure-compiler.appspot.com/home`

Конечно, наилучший метод оптимизации javascript &mdash; неиспользование javascript ;)

### Долой изображения! Да здравствуют шрифты!

Обычно изображения загружаются дольше, чем шрифты или стили. Много мелких изображений и вообще сейчас моветон. А не заменить ли их чем получше? Например, модными шрифтами. <b>Fontello</b> спешит на помощь.

На странице проекта `http://fontello.com/` вам будет предложено выбрать несколько шрифтов-кнопок по вкусу. Также сразу нужно обратить внимание на настройки, они поистине замечательны. У вас есть возможность выбрать размер шрифта, при надобности указать CSS-префикс и даже кодировку. После того, как разберётесь с этими настройками, кликом начинайте выбирать нужные шрифты. Их упакуют в архив вместе с примером, разнообразными CSS-стилями, HOWTO и demo-страницей, призванной показать как оно будет выглядеть. А выглядит оно очень недурно. На буржуинских сайтах используется довольно часто в то время как на большинстве отечественных по какой-то неведомой автору причине предпочитают таки иметь дело с изображениями.

### Или оптимизируем изображения

<b>Yahoo Smush.it</b> рулит и педалит. Позволяет сжимать изображения практически без потери качества. Картинки, которые планируется подвергнуть эксперименту, можно загружать как с жёсткого диска своей машины так и указывать к ним URL-путь. На выходе вам сообщат исходный размер и размер сжатого изображения, а также позволят загрузить архив, его содержащий. Действительно сто&#x301;ящий сервис, использую не первый год, нареканий нет.

`http://www.smushit.com/ysmush.it/`

Как правило, первыми кандидатами на сжатие становятся такие константы (в том смысле, что они неизменяемы) как всевозможные элементы самого веб-сайта: шапка, кнопки... Хотя если не лениться, можно прогонять и отдельные изображения для статей.

Но в некоторых случаях требуется ещё более жёсткий подход. Если страница просто ломится от картинок (пример: объёмный пост со множеством изображений или галерея какая-нибудь), полная загрузка её может занимать достаточно продолжительное время. Дабы избежать этого неприятного момента, можно загружать картинки лишь тогда, когда взор читателя обратится к ним.

В этом посильную помощь нам окажет один из скриптов с сайта jquery.com: `http://plugins.jquery.com/lazyload/`. Для его использования придётся подключить jquery:

```html
<head>
<script src='http://code.jquery.com/jquery-2.0.3.min.js' type="text/javascript"></script>
<script src='путь_к_скрипту.js' type="text/javascript"></script>
<!--вызов функции скрипта-->
<script type="text/javascript">
    $("img.lazy").lazyload({
    effect : "fadeIn"
    });
</script>
</head>
```

Чтобы это сработало, изображению нужно присвоить класс `.lazy`:

```html
<img class="lazy" src="img.gif" data-original="example.jpg">
```

Вот и всё. До связи!
