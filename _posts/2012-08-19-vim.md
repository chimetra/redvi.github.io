---
layout: post
title: Vim как основной текстовый редактор
date: 2012-08-19 1:15
tags: [editors]
slug: vim
author: redVi
Summary: Есть такой замечательный редактор - vim. Насколько он удобен в использовании, настолько и сложен в освоении.
---

Есть такой замечательный редактор &mdash; vim. Насколько он удобен в использовании, настолько и сложен в освоении. Помнится, когда автору впервые пришлось открыть сие чудо работы с текстом, минут семь было затрачено на поиск того, как же это дело теперь закрыть.

На самом деле vim содержит большое количество труднозапоминаемых команд, но использовать их все как правило не приходится. Ниже представлен список основных команд, нужных для обычной повседневной работы, а также файл `.vimrc`, очень простой, содержащий лишь строку &mdash; самую главную.

Итак, основные команды для работы с vim.

Если вы открыли vim без предварительного чтения какого-либо справочного материала, спешу радостно сообщить вам, что вы обречены продолжить свой путь в поисковой системе, с глазами по чайнику и одним-единственным вопросом "как выйти из vim". Поэтому давайте начнём  сглавного, а именно:


### Выход из текстового редактора

- `:q + !` - выйти без сохранения документа
- `:w + q` - записать изменения и выйти

Вам следует знать, что vim имеет три режима для различных действий. Это может быть просмотр, вставка текста или же вставка команд.

### Режимы в vim


- `ESC` - переключение к визуальному режиму
- `:` - переключение к командному режиму ( для вставки команд )
- `i` - перейти в режим вставки текста

### Работа с текстом, вставка/замена/копирование

- `i` - вставка текста
- `r + нужная буква` - замена буквы в слове на нужную (при опечатке, например)
- `4 + dd` - удалить 4 строки
- `3 + x` - удалить 3 символа
- `shift + d` - удалить от текущей позиции до конца строки
- `:% + s + /old/new/ + g` - заменить все слова 'old' на 'new'
- `:r + file.txt`  - прочитать и вставить содержимое файла 'file.txt' в место под курсором
- `:0r + file.txt`  - вставить файл в начало документа
- `:$ + r + file.txt`  - вставить файл в конец документа
- `:w + >> + ~/file.txt`  -  дописать содержимое буфера в конец другого файла
- `s` - замена текущего символа
- `shift + s` - замена текущей строки
- `d + 1` - удалить один символ
- `d + w` - удалить слово
- `d + d` - удалить строку
- `y + y` - скопировать строку
- `y + a + p` - скопировать абзац
- `p` - вставить
- `u` - отменить изменение
- `ctrl + r` - восстановить отменённый текст
- `:earlier + 5m` - воссоздать текст таким, каким он был 5 минут назад
- `:later + 10s` - наоборот переместиться на 10 секунд вперёд

### Перемещение по тексту

- `w` - передвинуть курсор вперед на одно слово
- `b` - передвинуть курсор назад на одно слово
- `0` - передвинуть курсор на начало текущей строки
- `$` - передвинуть курсор на конец текущей строки
- `5 + e` - перейти к пятому слову от курсора
- `}` - перейти к следующему параграфу
- `35 + j` - на 35 строк вниз
- `35 + k` - на 35 строк вверх
- `5 + l` - на 5 символов вправо
- `5 + h` - на 5 символов влево
- `50 + shift + g` - на страницу 50
- `%` - перейти к парной скобке

### Поиск по тексту/выделение

- `/ + g` - искать слова, начинающиеся на "g"
- `n` - перейти к следующему слову в поиске
- `shift + n` - перейти к предыдущему слову в поиске
- `v + %` - когда курсор установлен на одной из скобок - выделит всё до её пары.
- `vi + b` - выделить всё между двумя ближайшими к курсору круглыми скобками
- `vi + B` - выделить всё между двумя ближайшими к курсору фигурными скобками
- `vi + "` - выделить всё между двумя ближайшими двойными кавычками
- `vi + '` - выделить всё между двумя ближайшими одинарными кавычками
- `gg + VG` - выделить весь файл

### Разное

Открыть файл, но предопределить синтаксис редактора:

- `$ vim "+set filetype=lisp" file.rb`
- `Ctrl + wv` - разбить окно по вертикали
- `Ctrl + ww` - переключиться между окнами
- `$ vim -R` - открыть файл только для чтения
- `:set local spell spelllang = en_us` - проверка орфографии
- `:tabedit + file` - открыть файл во вкладке
- `:tabnew` - открыть новую вкладку в новом буфере
- `:tabc или :q` - закрыть вкладку
- `:sp` - разделить окно
- `m + имя закладки` - создать закладку в тексте
- `' + имя закладки` - вернуться к закладке
- `vim ftp://ftp.site.com/file` - правка документа по ftp
- `:! + command` - запустить команду оболочки в vim, где command - нужная команда
- `:Vex или :Sex` - открытие дерева каталогов

### Комментирование кода:

Чтобы закомментировать участок кода:

- `ctrl + v` - выделяем нужный участок
- `shift + i` - вставляем знак комментария
- `ESC` - подтвердить

Удалить участок кода:

- `ctrl + v` - выделить участок для удаления
- `shift + x` - удалить выделенные символы (символы комментария)

### "Табличное" копирование

- `ctrl + v` - для выделения текста
- `3 + j` - для перехода на три строки вниз
- `$` - перемещение курсора в конец строки
- `y` - копирование
- `p` - вставка

Таким образом, можно скопировать не отдельные строки, а таблицу из файла

Чтобы горячие клавиши vim легче запомнились, можно держать перед глазами или "вклеить" в обои рабочего стола вставки с ними:

- для светлого фона:

![vim light](http://4.bp.blogspot.com/-VFQ86ePWBf0/UTd3jbNJUtI/AAAAAAAAEGY/q-4lH_0--SA/s1600/vim_table.png)

-для тёмного фона:

![vim dark](http://2.bp.blogspot.com/-1j6nmxzR4CA/UTd3s4LFoSI/AAAAAAAAEGg/F-RnTlJdiLI/s1600/vim.png)

### Плагины

Для vim существует огромное количество самых разных плагинов, призванных расширить функционал или же упростить работу с этим текстовым редактором. Из vim можно даже сделать настоящий IDE: попробуйте установить Eclim, если вам это нужно.

Все доступные плагины следует найти и забрать со страницы [vim.org](http://www.vim.org/index.php). Рассмотрим некоторые из них.

- поддержка языка python.

Скачать плагин можно со страницы <http://www.vim.org/scripts/script.php?script_id=1439>, после чего нужно положить его в директорию `~/.vim/compiler` и дать команду `:make` для сборки плагина.

- Плагин Project

станет неплохим подспорьем при создании новых проектов. Забрать здесь: <http://www.vim.org/scripts/script.php?script_id=69>

Распаковать в `~/.vim/` и запустить командой `:Project`.

- Поддержка шаблонов

также сэкономит немало времени, если вы пишете один и тот же код во многих файлах. Это могут быть html-теги или же указание к пути интерпретатора в каждом файле python. Местонахождение плагина <http://www.vim.org/scripts/script.php?script_id=2834>

После скачивания плагина создайте директорию `.vim/templates/` с необходимыми шаблонами и укажите редактору на них. Например:

```vim
# .vimrc
:autocmd BufNewFile  *.py      0r ~/.vim/templates/template.py
:autocmd BufNewFile *.html     0r ~/.vim/templates/template.html
```

Это значит, что подготовленные нами шаблоны будут подгружаться каждый раз, когда мы создаём новый файл с одним из указанных форматов.

- плагин xml for vim

<http://www.vim.org/scripts/script.php?script_id=301> будет автоматически закрывать теги.

### Кодировка

Часто кириллица отображается в виде разнообразных "кракозябр", если исходный файл был получен в кодировке cp-1251. Но мы можем отобразить всё нормально. Для этого нужно открыть исходный файл и внести некоторые преобразования:

```console
$ vim file.txt
:e ++enc=cp-1251
```

Сейчас всё должно быть нормально.

Теперь небольшая доводка `.vimrc`

```vim
- Включить подсветку синтаксиса
syntax on
- Отображать номера строк
set number
- Настройки табуляции
set tabstop=4
set shiftwidth=4
set smarttab
- Запоминать историю команд
set history=50
- Переносить длинные строки
set wrap
- Цвет комментариев
highlight Comment ctermfg=Green
- Отключить "звуковое сопровождение" редактора
set vb t_vb=
- Настройки порядка кодировки и формата файлов
set ffs=unix,dos,mac
set fencs=utf-8,cp1251,koi8-r,ucs-2,cp866
- Автозакрытие фигурных скобок и кавычек

:inoremap " "" <LEFT>
imap [ []<LEFT>
imap ( ()<LEFT>
imap { {}<LEFT>
- Отключение создания файлов бекапа и свапа
set nobackup
set nowritebackup
set noswapfile
```

### Цветовые схемы vim

Можно использовать встроенный набор цветовых схем. Дабы выбрать какую-то из них, откройте vim и введите:

```vim
colorcheme имя-схемы
```

Просмотреть все цветовые схемы:

```vim
:colorscheme
```

Для подстановки выбранной схемы жмите `< Tab >`

Также можно найти привлекательные цветовые схемы на просторах Интернета. Они представляют собой текстовый файл настроек с расширением `.vim`, и класть такие файлы следует в директорию `~./vim/colors`, после чего прописать в `.vimrc` выбранную тему.

### Vim автокомплит

Да, у vim много возможностей, большинство из которых реализованы в виде плагинов. Например, будет намного удобнее, если вместо ввода всего слова, мы пишем лишь часть, жмём `tab` - остальное дописывает vim. Автодополнение, да ещё и умное! Для этого нужно скачать плагин `SuperTab`, открыть его в vim и выполнить команду:

```
:so%
```

Плагин будет автоматически собран. Все его файлы помещены в директорию `.vim/`

`.vimrc` автора (или лучше [забрать с github](https://github.com/redVi/dotfiles/tree/master/vim))

```vim
syntax on
set number
set tabstop=4
set shiftwidth=
set smarttab
" Включаем 'умную' автоматическую расстановку отступов
set smartindent
" Копирует отступ от предыдущей строки
set autoindent
set history=50
set wrap
set vb t_vb=
set ffs=unix,dos,mac
set fencs=utf-8,cp1251,koi8-r,ucs-2,cp866
:inoremap " "" <LEFT>
imap [ []<LEFT>
imap ( ()<LEFT>
imap { {}<LEFT>
set nobackup
set nowritebackup
set noswapfile
set foldenable
set fdm=syntax
set foldopen=all
" :colorscheme railscasts"
:colorscheme codeschool
set background=dark
" Включаем подсветку выражения, которое ищется в тексте
set hlsearch
"Настройки сворачивания блоков кода (фолдинг)
set foldenable " включить фолдинг
set foldmethod=syntax " определять блоки на основе синтаксиса файла
set foldcolumn=3 " показать полосу для управления сворачиванием
filetype plugin on " автоматически определять тип файла
```

<b>P.S.</b> рекомендации по поводу нужных настроек и дополнительных плагинов приветствуются

